"use strict";const assetsPath="assets/stardew/",shedWidth=390,shedHeight=437;let selectedWallpaper="001",selectedFlooring="01",images=Object.create(null),previewRegion=document.getElementsByClassName("preview-region")[0],previewArea=document.getElementsByClassName("preview-area")[0],canvas=null,selectionRegion=document.getElementsByClassName("selection-region")[0],wallpaperArea=document.getElementsByClassName("wallpaper-area")[0],wallpaperContents=document.getElementsByClassName("wallpaper-contents")[0],flooringArea=document.getElementsByClassName("flooring-area")[0],flooringContents=document.getElementsByClassName("flooring-contents")[0];function imageLoadPromise(e){return new Promise((a,t)=>{e.addEventListener("load",()=>{a()}),e.addEventListener("error",()=>{t()})})}function setup(e){let a=[];canvas=document.createElement("canvas"),canvas.width=390,canvas.height=437,previewArea.appendChild(canvas);let t=document.createElement("img");t.src=assetsPath+"Shed_Inside.png",t.style.display="none",previewArea.appendChild(t),a.push(imageLoadPromise(t)),images["background/shed"]=t;let n=setupWallpaperChoices(wallpaperContents);a=a.concat(n);let l=setupFlooringChoices(flooringContents);a=a.concat(l),Promise.all(a).then(()=>{drawShed(selectedWallpaper,selectedFlooring),document.body.classList.remove("is-loading"),centerPreview()})}function setupWallpaperChoices(e){let a=[];for(let t=1;t<=112;t++){let n=t.toString();n="0".repeat(3-n.length)+n;let l=document.createElement("span");l.classList.add("wallpaper-choice"),l.addEventListener("click",e=>{selectedWallpaper=n,drawShed(selectedWallpaper,selectedFlooring)}),l.addEventListener("mouseenter",e=>{drawShed(n,selectedFlooring)}),l.addEventListener("mouseleave",e=>{drawShed(selectedWallpaper,selectedFlooring)}),e.appendChild(l);let s=document.createElement("img");s.classList.add("wallpaper-icon"),s.src=assetsPath+"Wallpaper_000_Icon.png".replace("000",n),l.appendChild(s);let o=document.createElement("img");o.src=assetsPath+"Wallpaper_000.png".replace("000",n),o.style.display="none",l.appendChild(o),a.push(imageLoadPromise(s)),a.push(imageLoadPromise(o)),images["wallpaper/"+n]=o}return a}function setupFlooringChoices(e){let a=[];for(let t=1;t<=56;t++){let n=t.toString();n="0".repeat(2-n.length)+n;let l=document.createElement("span");l.classList.add("flooring-choice"),l.addEventListener("click",()=>{selectedFlooring=n,drawShed(selectedWallpaper,selectedFlooring)}),l.addEventListener("mouseenter",()=>{drawShed(selectedWallpaper,n)}),l.addEventListener("mouseleave",()=>{drawShed(selectedWallpaper,selectedFlooring)}),e.appendChild(l);let s=document.createElement("img");s.classList.add("flooring-icon"),s.src=assetsPath+"Flooring_00_Icon.png".replace("00",n),l.appendChild(s);let o=document.createElement("img");o.src=assetsPath+"Flooring_00.png".replace("00",n),o.style.display="none",l.appendChild(o),a.push(imageLoadPromise(s)),a.push(imageLoadPromise(o)),images["flooring/"+n]=o}return a}function drawShed(e,a){let t=canvas.getContext("2d");t.drawImage(images["background/shed"],0,0,390,437),t.save(),drawFlooring(t,a),t.restore(),t.save(),drawWallpaper(t,e),t.restore()}function drawWallpaper(e,a){e.beginPath(),e.moveTo(19,20),e.lineTo(19,116),e.lineTo(371,116),e.lineTo(371,20),e.clip();let t=images["wallpaper/"+a];for(var n=0;n<=3;n++)e.drawImage(t,19+96*n,20)}function drawFlooring(e,a){e.beginPath(),e.moveTo(19,110),e.lineTo(19,376),e.lineTo(32,388),e.lineTo(177,388),e.lineTo(179,390),e.lineTo(179,420),e.lineTo(211,420),e.lineTo(211,390),e.lineTo(213,388),e.lineTo(358,388),e.lineTo(371,376),e.lineTo(371,110),e.clip();let t=images["flooring/"+a];for(var n=0;n<=4;n++)for(var l=0;l<=3;l++)e.drawImage(t,19+128*n,20+128*l)}function centerPreview(){let e=document.getElementsByClassName("preview-area")[0];if(window.innerWidth<720)return void(e.style.top="");let a=(window.innerHeight-e.getBoundingClientRect().height)/3;a=Math.max(a,32),a=Math.round(a),e.style.top=a+"px"}function main(){setup(document.getElementsByClassName("container")[0]),window.addEventListener("resize",centerPreview)}main();